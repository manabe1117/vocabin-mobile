# ğŸ›¡ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€Shai-Hulud ãƒãƒ«ã‚¦ã‚§ã‚¢å¯¾ç­–ã¨ã—ã¦å®Ÿè£…ã•ã‚ŒãŸã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ©Ÿèƒ½ã‚’ä¸€è¦§åŒ–ã—ã¾ã™ã€‚

---

## âœ… å®Ÿè£…æ¸ˆã¿ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–

### ãƒ¬ã‚¤ãƒ¤ãƒ¼ 1: npm ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¿è­·

| å¯¾ç­– | å†…å®¹ | ãƒ•ã‚¡ã‚¤ãƒ« |
|-----|------|--------|
| âœ… ã‚¹ã‚¯ãƒªãƒ—ãƒˆç„¡åŠ¹åŒ– | `ignore-scripts=true` | `.npmrc` |
| âœ… ãƒãƒ¼ã‚¸ãƒ§ãƒ³å›ºå®š | `save-exact=true` | `.npmrc` |
| âœ… ãƒ­ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«å¿…é ˆ | `package-lock=true` | `.npmrc` |
| âœ… è„†å¼±æ€§ç›£æŸ» | `audit=true` | `.npmrc` |

### ãƒ¬ã‚¤ãƒ¤ãƒ¼ 2: Cursor IDE ä¿è­·

| å¯¾ç­– | å†…å®¹ | ãƒ•ã‚¡ã‚¤ãƒ« |
|-----|------|--------|
| âœ… è‡ªå‹•å®Ÿè¡Œç„¡åŠ¹åŒ– | `npm.autorun: off` | `.vscode/settings.json` |
| âœ… ãƒ•ã‚©ãƒ«ãƒ€å®Ÿè¡Œç„¡åŠ¹ | `npm.enableRunFromFolder: false` | `.vscode/settings.json` |

### ãƒ¬ã‚¤ãƒ¤ãƒ¼ 3: Git Hooks ä¿è­·

| å¯¾ç­– | å†…å®¹ | ãƒ•ã‚¡ã‚¤ãƒ« |
|-----|------|--------|
| âœ… Pre-commit ãƒã‚§ãƒƒã‚¯ | package.json å¤‰æ›´æ™‚ã«è‡ªå‹•å®Ÿè¡Œ | `.git/hooks/pre-commit` |
| âœ… ãƒãƒ«ã‚¦ã‚§ã‚¢æ¤œæŸ» | Shai-Hulud æ¤œæŸ»ã‚¹ã‚¯ãƒªãƒ—ãƒˆ | `scripts/check-malware.js` |
| âœ… è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³ | npm audit å®Ÿè¡Œ | `scripts/check-malware.js` |
| âœ… ãƒ­ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«æ¤œè¨¼ | æ•´åˆæ€§ç¢ºèª | `scripts/check-malware.js` |

### ãƒ¬ã‚¤ãƒ¤ãƒ¼ 4: é–‹ç™ºæ”¯æ´

| å¯¾ç­– | å†…å®¹ | ãƒ•ã‚¡ã‚¤ãƒ« |
|-----|------|--------|
| âœ… ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚¯ãƒªãƒ—ãƒˆ | `security:audit`, `security:check` | `package.json` |
| âœ… Cursor ã‚¿ã‚¹ã‚¯ | IDEçµ±åˆãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯å®Ÿè¡Œ | `.vscode/tasks.json` |
| âœ… ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ | ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰ | `docs/SECURITY-SETUP.md` |

---

## ğŸ”„ ä¿è­·ãƒ•ãƒ­ãƒ¼å›³

```
ã‚·ãƒŠãƒªã‚ª: æ–°è¦ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’è¿½åŠ 

1ï¸âƒ£ package.json ç·¨é›†
   â†“
2ï¸âƒ£ git add package.json
   â†“
3ï¸âƒ£ git commit
   â†“
4ï¸âƒ£ Pre-commit Hook è‡ªå‹•å®Ÿè¡Œ âš ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯
   â”œâ”€ npm audit
   â”œâ”€ ãƒãƒ«ã‚¦ã‚§ã‚¢æ¤œæŸ»ï¼ˆShai-Huludï¼‰
   â””â”€ ãƒ­ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«æ¤œè¨¼
   â†“
   âœ… ãƒã‚§ãƒƒã‚¯æˆåŠŸ â†’ commit å®Œäº†
   âŒ ãƒã‚§ãƒƒã‚¯å¤±æ•— â†’ commit ä¸­æ­¢ï¼ˆæ‰‹å‹•ä¿®æ­£ãŒå¿…è¦ï¼‰
   â†“
5ï¸âƒ£ npm install ï¼ˆæ‰‹å‹•å®Ÿè¡Œï¼‰
   â†“
6ï¸âƒ£ .npmrc è¨­å®šãŒè‡ªå‹•é©ç”¨ âš ï¸ å¤šå±¤é˜²å¾¡
   â”œâ”€ ã‚¹ã‚¯ãƒªãƒ—ãƒˆè‡ªå‹•å®Ÿè¡Œãªã—
   â”œâ”€ è„†å¼±æ€§ç›£æŸ»å®Ÿè¡Œ
   â””â”€ ãƒãƒ¼ã‚¸ãƒ§ãƒ³å®Œå…¨å›ºå®š
   â†“
âœ… å®‰å…¨ãªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Œäº†
```

---

## ğŸ“Š ä¿è­·ãƒ¬ãƒ™ãƒ«ã®æ®µéš

### ãƒ¬ãƒ™ãƒ« 1: ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã®ä¿è­·
```bash
npm install
        â†“
.npmrc ãŒèª­è¾¼
        â†“
âœ… ignore-scripts=true é©ç”¨
âœ… audit=true é©ç”¨
```

**åŠ¹æœ**: Shai-Hulud ã® postinstall ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œã‚’é˜²æ­¢

### ãƒ¬ãƒ™ãƒ« 2: Cursor ã®è‡ªå‹•å®Ÿè¡Œé˜²æ­¢
```
Cursor ãŒ npm install ææ¡ˆ
        â†“
IDE è¨­å®šã§ç„¡åŠ¹åŒ–
        â†“
âŒ è‡ªå‹•å®Ÿè¡Œã•ã‚Œãªã„
âœ… æ‰‹å‹•å®Ÿè¡Œã‚’å¼·åˆ¶
```

**åŠ¹æœ**: ç„¡æ„è­˜çš„ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¾µå®³ã‚’é˜²æ­¢

### ãƒ¬ãƒ™ãƒ« 3: æ–°è¦ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸äº‹å‰æ¤œæŸ»
```bash
package.json å¤‰æ›´
        â†“
git commit
        â†“
Pre-commit Hook ãƒˆãƒªã‚¬ãƒ¼
        â†“
npm run security:check å®Ÿè¡Œ
        â†“
âœ… ãƒã‚§ãƒƒã‚¯æˆåŠŸ â†’ å®‰å…¨ãªæ–°è¦ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
âŒ ãƒã‚§ãƒƒã‚¯å¤±æ•— â†’ commit ä¸­æ­¢
```

**åŠ¹æœ**: æ–°è¦ãƒãƒ«ã‚¦ã‚§ã‚¢ä¾µå…¥ã‚’äº‹å‰ã«æ¤œå‡º

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

å®Ÿè£…ãŒæ­£ã—ãæ©Ÿèƒ½ã—ã¦ã„ã‚‹ã‹ç¢ºèªã™ã‚‹ãŸã‚ã®ãƒ†ã‚¹ãƒˆï¼š

### ãƒ†ã‚¹ãƒˆ 1: .npmrc ãŒæœ‰åŠ¹
```bash
npm config list | grep ignore-scripts
# çµæœ: ignore-scripts = true
```
âœ… Expected Output: `ignore-scripts = true`

### ãƒ†ã‚¹ãƒˆ 2: Git Hooks ãŒæœ‰åŠ¹
```bash
ls -la .git/hooks/pre-commit
# çµæœ: -rwxr-xr-x
```
âœ… Expected Output: å®Ÿè¡Œæ¨©é™ã‚ã‚Š

### ãƒ†ã‚¹ãƒˆ 3: Cursor è¨­å®šãŒé©ç”¨
```bash
cat .vscode/settings.json | grep npm.autorun
# çµæœ: "npm.autorun": "off"
```
âœ… Expected Output: `off` ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹

### ãƒ†ã‚¹ãƒˆ 4: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå®Ÿè¡Œå¯èƒ½
```bash
npm run security:check
# çµæœ: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯å®Ÿè¡Œ
```
âœ… Expected Output: ãƒã‚§ãƒƒã‚¯çµæœãŒè¡¨ç¤ºã•ã‚Œã‚‹

---

## ğŸ“‹ FAQ

### Q1: npm install ãŒå¤±æ•—ã—ãŸå ´åˆã¯ï¼Ÿ
```bash
# è©³ç´°ã‚’ç¢ºèª
npm run security:audit

# è„†å¼±æ€§ãŒã‚ã‚‹å ´åˆã¯ä¿®æ­£
npm audit fix

# ä¿®æ­£å¾Œã€å†åº¦ install
npm install
```

### Q2: ç·Šæ€¥ã§ commit ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ãŸã„å ´åˆã¯ï¼Ÿ
```bash
# --no-verify ãƒ•ãƒ©ã‚°ã‚’ä½¿ç”¨
git commit -m "message" --no-verify

# âš ï¸ æ³¨æ„: ç·Šæ€¥æ™‚ã®ã¿ä½¿ç”¨
```

### Q3: Pre-commit Hook ã‚’ç„¡åŠ¹åŒ–ã—ãŸã„å ´åˆã¯ï¼Ÿ
```bash
# ç„¡åŠ¹åŒ–
chmod -x .git/hooks/pre-commit

# å†åº¦æœ‰åŠ¹åŒ–
chmod +x .git/hooks/pre-commit
```

### Q4: æ—¢å­˜ã® package-lock.json ã¯å®‰å…¨ã‹ï¼Ÿ
```bash
# æ•´åˆæ€§ã‚’ç¢ºèª
npm ci --dry-run

# ä¿®å¾©ãŒå¿…è¦ãªå ´åˆ
npm install
```

---

## ğŸš€ æ¨å¥¨ã•ã‚Œã‚‹ä½¿ç”¨ãƒ•ãƒ­ãƒ¼

### é€šå¸¸ã®é–‹ç™º
```bash
# æ—¢å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install           â† å®‰å…¨ï¼ˆ.npmrc ãŒæœ‰åŠ¹ï¼‰
npm start             â† ã‚¢ãƒ—ãƒªèµ·å‹•
```

### æ–°è¦ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸è¿½åŠ 
```bash
# 1. package.json ã‚’ç·¨é›†
# "new-package": "^1.0.0" ã‚’è¿½åŠ 

# 2. Git ã«ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°
git add package.json

# 3. Commit ï¼ˆè‡ªå‹•ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯ï¼‰
git commit -m "feat: add new-package"
# â† Pre-commit Hook ãŒè‡ªå‹•å®Ÿè¡Œ

# 4. ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install           â† å®‰å…¨ï¼ˆ.npmrc + ãƒã‚§ãƒƒã‚¯æ¸ˆã¿ï¼‰

# 5. ç¢ºèª
npm run security:audit  â† è¿½åŠ ã§ç¢ºèªï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
```

---

## ğŸ“ å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆ

| å•é¡Œ | ç¢ºèªé …ç›® | å¯¾å¿œ |
|-----|--------|------|
| npm install ãŒé…ã„ | `audit=true` ãŒæœ‰åŠ¹ | è„†å¼±æ€§ãƒã‚§ãƒƒã‚¯ã®å‰¯ä½œç”¨ï¼ˆå®‰å…¨ã®ãŸã‚ï¼‰ |
| Git Hooks ãŒå®Ÿè¡Œã•ã‚Œãªã„ | `chmod +x .git/hooks/pre-commit` | å®Ÿè¡Œæ¨©é™ãŒãªã„å¯èƒ½æ€§ |
| Cursor ãŒ npm install ã‚’ææ¡ˆ | `.vscode/settings.json` ç¢ºèª | IDE è¨­å®šãŒç„¡åŠ¹åŒ–ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª |
| ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯å¤±æ•— | `npm run security:check` | è©³ç´°ãƒ­ã‚°ã§å•é¡Œã‚’ç‰¹å®š |

---

## ğŸ“ å‚è€ƒè³‡æ–™

- [Shai-Hulud ãƒãƒ«ã‚¦ã‚§ã‚¢ã«ã¤ã„ã¦](./SECURITY-CHECK.md)
- [ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰](./docs/SECURITY-SETUP.md)
- [npm audit ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://docs.npmjs.com/cli/v8/commands/npm-audit)
- [npm .npmrc è¨­å®š](https://docs.npmjs.com/cli/v8/configuring-npm/npmrc)

