# 本番環境への広告設定ガイド

このドキュメントはアプリをリリースする前に本番用の広告 ID を設定するための手順です。

---

## 📋 本番環境へのチェックリスト

リリース前に以下のすべてを確認してください：

- [ ] Google AdMob ダッシュボードでアプリが登録されている
- [ ] 本番用の広告ユニット ID を取得している
- [ ] `config/admob.ts` に本番 ID が設定されている
- [ ] テストデバイスの登録がクリアされている
- [ ] ローカルでテストして問題がないことを確認している
- [ ] App Store/Google Play で申請する準備ができている

---

## 🚀 ステップ 1: Google AdMob ダッシュボードで ID を取得

### 1-1. AdMob にログイン

```
https://admob.google.com
```

### 1-2. アプリを登録

1. **Apps** → **Add app**
2. プラットフォーム選択
   - Android の場合は **Android**
   - iOS の場合は **iOS**
3. アプリ情報を入力
   - アプリ名: `Vocabin`
   - パッケージ名: `com.takumi.vocabin` (Android)
   - Bundle ID: `com.takumi.vocabin` (iOS)

### 1-3. 広告ユニットを作成

各画面ごとに広告ユニットを作成します：

```
① ホーム画面用バナー広告
② 翻訳画面用バナー広告
③ 辞書画面用バナー広告
④ 学習画面用バナー広告
⑤ インタースティシャル広告（全画面）
⑥ リワード広告（報酬付き）
```

#### 広告ユニット作成手順

1. **Apps** → **Vocabin** → **Ad units**
2. **Add ad unit**
3. 広告フォーマット選択
   - バナー → **Banner**
   - インタースティシャル → **Interstitial**
   - リワード → **Rewarded**
4. ユニット名入力（例：`Vocabin_Home_Banner`）
5. **Create and continue**

#### 各画面ごとの ID を記録

作成後、以下のような ID が表示されます：

```
ca-app-pub-xxxxxxxxxxxxxxxx/xxxxxxxxxx
```

この ID をメモしておいてください。

---

## 🔧 ステップ 2: config/admob.ts を更新

### 現在のコード

```typescript
// ❌ テスト用ID
export const ADMOB_UNIT_IDS = {
  HOME_BANNER: isDevelopment
    ? "ca-app-pub-3940256099942544/6300978111"
    : "YOUR_PRODUCTION_HOME_BANNER_ID", // ← ここを変更
  // ...
};
```

### 変更後のコード

```typescript
// ✅ 本番用ID
export const ADMOB_UNIT_IDS = {
  HOME_BANNER: isDevelopment
    ? "ca-app-pub-3940256099942544/6300978111"
    : "ca-app-pub-1234567890123456/1234567890", // 実際のID

  DICTIONARY_BANNER: isDevelopment
    ? "ca-app-pub-3940256099942544/6300978111"
    : "ca-app-pub-1234567890123456/9876543210",

  TRANSLATE_BANNER: isDevelopment
    ? "ca-app-pub-3940256099942544/6300978111"
    : "ca-app-pub-1234567890123456/1111111111",

  STUDY_BANNER: isDevelopment
    ? "ca-app-pub-3940256099942544/6300978111"
    : "ca-app-pub-1234567890123456/2222222222",

  INTERSTITIAL: isDevelopment
    ? "ca-app-pub-3940256099942544/1033173712"
    : "ca-app-pub-1234567890123456/3333333333",

  REWARDED: isDevelopment
    ? "ca-app-pub-3940256099942544/5224354917"
    : "ca-app-pub-1234567890123456/4444444444",
};
```

### 重要: テストデバイスをクリア

```typescript
// ✅ 本番環境では空にする
export const TEST_DEVICE_IDS = [
  // 空のままにする
];
```

---

## 🧪 ステップ 3: ローカルでテストする

### 3-1. ビルド設定を本番モードに

```bash
# package.json のビルドコマンドを確認
cat package.json | grep build
```

### 3-2. ローカルで本番 ID で動作確認

```bash
# 本番用IDでアプリを実行
npm run android
# または
npm run ios
```

### 3-3. 各画面で広告が表示されることを確認

- [ ] ホーム画面 - 広告が表示される
- [ ] 翻訳画面 - 広告が表示される
- [ ] 辞書画面 - 広告が表示される
- [ ] 学習画面 - 広告が表示される

### 3-4. コンソールを確認

```
✅ AdMob initialized (production mode)
```

**重要: 本番 ID で自分の広告をクリックしないでください！**

---

## 📦 ステップ 4: ビルド・申請

### Android の場合

```bash
# ビルド
npm run build:android

# Google Play に申請
npm run submit:android
```

### iOS の場合

```bash
# ビルド
eas build --platform ios

# App Store に申請
eas submit --platform ios
```

---

## ✅ リリース後のモニタリング

### AdMob ダッシュボードで確認すること

1. **Earnings（収益）**

   - グラフが上昇しているか
   - 0 円になっていないか

2. **Ad Requests（リクエスト数）**

   - ユーザーが増えるにつれて増加しているか

3. **Impression Share（表示率）**

   - 100% に近いか（70% 以上が目安）

4. **Estimated earnings（推定収益）**
   - 毎日更新されているか

### アラート設定

AdMob で以下の異常を検知した場合、自動でメールが届きます：

```
❌ Abnormal activity detected
   → 自動で広告配信が停止される可能性
```

---

## 🚨 トラブルシューティング

### 問題 1: 広告が表示されない

```
原因1: 広告ユニットIDが間違っている
→ AdMob で正しいIDを確認

原因2: ネットワーク接続がない
→ インターネット接続を確認

原因3: AdMob がアプリを承認していない
→ 24時間待つ（新規アプリの場合）
```

### 問題 2: 収益が発生していない

```
原因1: テスト用IDが混ざっている
→ すべてのIDを本番用に変更

原因2: 自分のデバイスからのクリック
→ 不正クリックとしてカウントされない

原因3: ユーザーが少ない
→ ユーザー数が増えるまで待つ
```

### 問題 3: アカウントが停止された

```
⚠️ 規約違反の可能性があります

確認事項:
- 自分で意図的にクリックしていないか
- テスト用IDを本番で使用していないか
- 過度な広告配置をしていないか

対応:
① Google AdMob サポートに連絡
② 規約違反がないか確認
③ 再度申請
```

---

## 📊 推奨される広告配置

### ユーザー体験を損なわない広告配置

```
❌ 避けるべき配置
- 画面の大部分を占める
- アプリを開くたびに表示
- ユーザーが操作できない時に表示

✅ 推奨される配置
- 画面の下部にバナー広告
- 自然なタイミングでインタースティシャル広告
- 明らかに「広告」と表示
```

### 推定月間収益の目安

| ユーザー数 | 推定月間収益    |
| ---------- | --------------- |
| 100        | ¥0-100          |
| 1,000      | ¥100-1,000      |
| 10,000     | ¥1,000-10,000   |
| 100,000    | ¥10,000-100,000 |

※ 実際の収益は広告タイプ・ユーザーの地域によって大きく異なります

---

## 📝 重要な注意事項

### ⚠️ AdMob 規約違反

```
❌ 絶対にやってはいけないこと

1. 自分の広告をクリックする
   → 不正クリックとして検知される

2. ユーザーをだまして広告をクリックさせる
   → インセンティブ不正として検知される

3. 複数のアカウントを作成して不正行為
   → すべてのアカウントが削除される

4. テスト用IDを本番に含める
   → アカウント監視の対象になる
```

### ✅ 適切な広告運営

```
推奨事項:

1. ユーザーの体験を最優先
   → 広告は必要最小限に

2. 透明性
   → 「広告」と明確に表示

3. 正当な操作のみ
   → 自分でテストしない

4. 定期的なモニタリング
   → AdMob ダッシュボードを確認
```

---

## 🎯 次のステップ

- [ ] リリース後、AdMob ダッシュボードで毎日確認
- [ ] ユーザーからのフィードバックを確認
- [ ] 月間のビジネスレポートを作成
- [ ] 必要に応じて広告配置を最適化

**質問があれば、AdMob サポートセンターまたはドキュメントを確認してください！**
